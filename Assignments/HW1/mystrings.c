#include <windows.h>
#include <stdio.h>

#define MIN_STR_LEN 4

// FindStr takes a buffer cwith the loaded file, and its size
// It then prints all null terminiated ASCII range strings
void FindString(char* buffer, DWORD bufferSize){
    char asciiMin = 32;
    char asciiMax = 126;
    int len = 0;
    int start = 0;
    
    // //your solution here!
    for(int i = 0; i<bufferSize;i++){
        //printf("%c",buffer[i]);
       
        if(buffer[i]>=asciiMin&&buffer[i]<=asciiMax){
            len++;
            //printf("%c",buffer[i]);
        }else if(buffer[i]==0&&len>3){
            printf("<string>%s</string>\n",&buffer[start]);
            len = 0;
            start = i+1;//find a new string
        }else{
            start = i+1;//find a new string
            len=0;
        }

        
    }
}

// Loads The file contents, calculates the size, then calls FindStr
void MyStrings (char * fileName){
    //GetFileSize
    DWORD fileSize;
    char* buffer;
    FILE *fp;

    fp = fopen(fileName,"rb");
    fseek(fp, 0L, SEEK_END);
    fileSize=ftell(fp);
    rewind(fp);
    buffer = (char*) malloc(fileSize);
    fread(buffer,fileSize,1,fp);
    FindString(buffer,fileSize);
    // //your solution here!

}

int main(int argc, char* argv[]){
    if(argc != 2){
        printf("Usage: %s <filename>\n", argv[0]);
        return 0;
    }
    printf("%s",argv[1]);
    MyStrings(argv[1]);
 
}